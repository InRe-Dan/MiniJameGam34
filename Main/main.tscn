[gd_scene load_steps=23 format=3 uid="uid://dw5auj6i3fjfj"]

[ext_resource type="Script" path="res://Main/main.gd" id="1_5t87c"]
[ext_resource type="PackedScene" uid="uid://c757dhd4hepca" path="res://Player/player.tscn" id="1_bg8e3"]
[ext_resource type="Script" path="res://Hazard/hazard_manager.gd" id="3_lubpb"]
[ext_resource type="Script" path="res://Jokes/joke_system.gd" id="3_wbmed"]
[ext_resource type="Script" path="res://Main/audience_manager.gd" id="4_8158h"]
[ext_resource type="Script" path="res://Hazard/hazard_spawn_data.gd" id="4_o1nxd"]
[ext_resource type="PackedScene" uid="uid://bko632gtiaj3s" path="res://Hazard/Hazards/tomato.tscn" id="5_l85j4"]
[ext_resource type="Script" path="res://Main/approval_rating.gd" id="7_id6l1"]
[ext_resource type="PackedScene" uid="uid://clt5oswt5gxrq" path="res://Jokes/dialogue_container.tscn" id="8_mh3dp"]

[sub_resource type="Gradient" id="Gradient_4vja1"]
offsets = PackedFloat32Array(0)
colors = PackedColorArray(0, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_syp3o"]
gradient = SubResource("Gradient_4vja1")

[sub_resource type="Gradient" id="Gradient_1mcgo"]
offsets = PackedFloat32Array(0, 0.654676, 0.66187)
colors = PackedColorArray(0.12, 0.09192, 0.0576, 1, 0.11, 0.08426, 0.0528, 1, 0, 0, 0, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_wc5b8"]
gradient = SubResource("Gradient_1mcgo")
width = 512
height = 512
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="Resource" id="Resource_wi5i0"]
script = ExtResource("4_o1nxd")
hazard = ExtResource("5_l85j4")

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_mip7o"]
normal = Vector2(1, 0)

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_n56nb"]
normal = Vector2(-1, 0)

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_0helb"]
normal = Vector2(0, 1)

[sub_resource type="WorldBoundaryShape2D" id="WorldBoundaryShape2D_ybwdi"]

[sub_resource type="Gradient" id="Gradient_iqffe"]
offsets = PackedFloat32Array(0)
colors = PackedColorArray(0, 0.278431, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_r06y5"]
gradient = SubResource("Gradient_iqffe")

[sub_resource type="Gradient" id="Gradient_wx4ct"]
offsets = PackedFloat32Array(0)
colors = PackedColorArray(0, 0.886275, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_iaam5"]
gradient = SubResource("Gradient_wx4ct")

[node name="Main" type="Node2D" groups=["main"]]
texture_filter = 1
script = ExtResource("1_5t87c")

[node name="Background" type="Sprite2D" parent="."]
position = Vector2(376, 283)
scale = Vector2(12.75, 9.84375)
texture = SubResource("GradientTexture2D_syp3o")

[node name="PlaceholderStage" type="Sprite2D" parent="."]
position = Vector2(361, 352)
texture = SubResource("GradientTexture2D_wc5b8")
region_enabled = true
region_rect = Rect2(0, 0, 512, 256)

[node name="Player" parent="." instance=ExtResource("1_bg8e3")]
position = Vector2(360, 400)
collision_mask = 34
movement_speed = 120.0
acceleration = 24.0

[node name="HazardManager" type="Node2D" parent="."]
script = ExtResource("3_lubpb")
hazards = Array[ExtResource("4_o1nxd")]([SubResource("Resource_wi5i0")])

[node name="Hazards" type="Node2D" parent="HazardManager"]

[node name="Audience" type="Node2D" parent="HazardManager" node_paths=PackedStringArray("spawn_y_level", "debug_label")]
position = Vector2(0, -1)
script = ExtResource("4_8158h")
spawn_y_level = NodePath("../../SpawnElevation")
debug_label = NodePath("../../DebugLabel")

[node name="Collision" type="Node2D" parent="."]

[node name="WorldBounds" type="StaticBody2D" parent="Collision"]
collision_layer = 32
collision_mask = 0

[node name="Left Wall" type="CollisionShape2D" parent="Collision/WorldBounds"]
shape = SubResource("WorldBoundaryShape2D_mip7o")

[node name="RightWall" type="CollisionShape2D" parent="Collision/WorldBounds"]
position = Vector2(720, 0)
shape = SubResource("WorldBoundaryShape2D_n56nb")

[node name="TopWall" type="CollisionShape2D" parent="Collision/WorldBounds"]
position = Vector2(360, -122)
shape = SubResource("WorldBoundaryShape2D_0helb")

[node name="BottomWall" type="CollisionShape2D" parent="Collision/WorldBounds"]
position = Vector2(358, 483)
shape = SubResource("WorldBoundaryShape2D_ybwdi")

[node name="Stage" type="StaticBody2D" parent="Collision"]
collision_layer = 16
collision_mask = 0

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="Collision/Stage"]
polygon = PackedVector2Array(121, 478, 135, 402, 168, 336, 231, 278, 294, 249, 362, 241, 427, 251, 485, 277, 534, 317, 574, 374, 594, 438, 600, 530, 119, 529, 122, 510, 122, 510)

[node name="SpectatorArea" type="StaticBody2D" parent="Collision"]
position = Vector2(360, 480)
collision_layer = 2
collision_mask = 0

[node name="Bounds" type="CollisionPolygon2D" parent="Collision/SpectatorArea"]
polygon = PackedVector2Array(240, 0, 236.354, -41.676, 225.526, -82.085, 207.846, -120, 183.851, -154.269, 154.269, -183.851, 120, -207.846, 82.085, -225.526, 41.676, -236.354, 0, -240, -41.676, -236.354, -82.085, -225.526, -120, -207.846, -154.269, -183.851, -183.851, -154.269, -207.846, -120, -225.526, -82.085, -236.354, -41.676, -240, 0, -360, 0, -360, -480, 360, -480, 360, 0)

[node name="Control" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_right = 720.0
offset_bottom = 480.0
grow_horizontal = 2
grow_vertical = 2

[node name="ApprovalRating" type="TextureProgressBar" parent="Control"]
unique_name_in_owner = true
custom_minimum_size = Vector2(30, 100)
layout_mode = 1
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = 237.0
offset_top = 298.0
offset_right = 267.0
offset_bottom = 400.0
grow_horizontal = 2
max_value = 1.0
step = 0.0
value = 0.5
fill_mode = 3
nine_patch_stretch = true
stretch_margin_left = 1
stretch_margin_top = 1
stretch_margin_right = 1
stretch_margin_bottom = 1
texture_under = SubResource("GradientTexture2D_r06y5")
texture_progress = SubResource("GradientTexture2D_iaam5")
script = ExtResource("7_id6l1")

[node name="JokeSystem" type="Node" parent="." node_paths=PackedStringArray("keypress_prompt_container", "dialogue_container")]
script = ExtResource("3_wbmed")
keypress_prompt_container = NodePath("PromptContainer")
dialogue_container = NodePath("DialogueContainer")

[node name="DialogueContainer" parent="JokeSystem" instance=ExtResource("8_mh3dp")]
offset_left = -1.0
offset_bottom = -384.0

[node name="PromptContainer" type="CenterContainer" parent="JokeSystem"]
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -249.0
offset_top = -54.0
offset_right = 251.0
offset_bottom = -12.0
grow_horizontal = 2
grow_vertical = 0

[node name="SpawnElevation" type="Marker2D" parent="."]
position = Vector2(360, -49)
gizmo_extents = 350.0

[node name="DebugLabel" type="Label" parent="."]
offset_left = 157.0
offset_top = 186.0
offset_right = 197.0
offset_bottom = 209.0
text = "Debug text"

[node name="VSlider" type="VSlider" parent="."]
custom_minimum_size = Vector2(0, 100)
offset_left = 637.0
offset_top = 300.0
offset_right = 653.0
offset_bottom = 400.0
max_value = 1.0
step = 0.0
value = 1.0

[connection signal="satisfaction_changed" from="." to="HazardManager" method="_on_main_satisfaction_changed"]
[connection signal="satisfaction_changed" from="." to="HazardManager/Audience" method="_on_main_satisfaction_changed"]
[connection signal="got_hit" from="Player" to="." method="_on_player_got_hit"]
[connection signal="joke_failed" from="JokeSystem" to="." method="_on_joke_system_joke_failed"]
[connection signal="joke_success" from="JokeSystem" to="." method="_on_joke_system_joke_success"]
[connection signal="value_changed" from="VSlider" to="." method="_on_v_slider_value_changed"]
